<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/MedhaviMonish/TwinSqueeze/main/results/loss_comparison.png"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/MedhaviMonish/TwinSqueeze/main/results/benchmark_charts/loss_compare_alpha_0.75.png"/><link rel="stylesheet" href="/_next/static/css/b42ee275af96bf75.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-9edee2920554d0a5.js"/><script src="/_next/static/chunks/4bd1b696-dc95eb63a9e79f5d.js" async=""></script><script src="/_next/static/chunks/517-5752a921451f8aa5.js" async=""></script><script src="/_next/static/chunks/main-app-fae9f1d243c67c3a.js" async=""></script><script src="/_next/static/chunks/932-8bfdd8b6c3b22a28.js" async=""></script><script src="/_next/static/chunks/app/blogs/twin-squeeze/page-a25cfe9e785361d0.js" async=""></script><title>Medhavi Monish</title><meta name="description" content="AI Blacksmith forging intelligence from scratch"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><base href="./"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="relative min-h-screen bg-cover bg-center bg-no-repeat bg-fixed" style="background-image:url(&#x27;/images/bg-home.png&#x27;)"><div class="bg-black/70 min-h-screen"><main class="relative min-h-screen bg-cover bg-center bg-no-repeat bg-fixed flex justify-center items-start py-20 px-4" style="background-image:url(&#x27;/images/bg-home.png&#x27;)"><div class="w-full max-w-4xl bg-black/80 text-white p-10 rounded-xl shadow-md"><a class="text-sm text-gray-400 hover:text-white transition block mb-4" href="/">← Back to Home</a><a target="_blank" rel="noopener noreferrer" class="text-blue-400 hover:underline text-base block mb-2" href="https://github.com/MedhaviMonish/TwinSqueeze">🔗 View on GitHub</a><h1 class="text-4xl font-bold text-ember mb-6">TwinSqueeze: Contrastive Compression with NEFTune Regularization</h1><p class="mb-6 leading-relaxed"><strong>TwinSqueeze</strong> is a Siamese network designed to compress high-dimensional sentence embeddings (e.g., 384-dim from MiniLM) into a smaller, task-optimized vector (e.g., 32-dim) while preserving cosine similarity. This project also systematically studies <strong>NEFTune</strong>, a noise-based regularization technique, to improve generalization and ranking quality.</p><h2 class="text-2xl font-bold text-ember mb-2">🎯 Goals</h2><ul class="list-disc list-inside mb-6 text-gray-400 leading-relaxed"><li>Compress 384-dim vectors to smaller sizes (e.g., 32-dim) for latency and memory gains</li><li>Preserve and align cosine similarity for task-specific domains</li><li>Support robust RAG pipelines with noise-tolerant NEFTune-optimized vectors</li></ul><h2 class="text-2xl font-bold text-ember mb-2">❗ Why Build TwinSqueeze?</h2><p class="mb-6 leading-relaxed">OpenAI’s 1536-dim embeddings are powerful but large and prone to spurious similarity. TwinSqueeze addresses two issues:<br/>- High dimensionality → slow search, more memory<br/>- Too much similarity between unrelated phrases</p><h2 class="text-2xl font-bold text-ember mb-2">🚀 Project Highlights</h2><ul class="list-disc list-inside mb-6 text-gray-400 leading-relaxed"><li>3-layer MLP Siamese encoder with cosine-based loss</li><li>Training on STS-B from GLUE with noise regularization (NEFTune)</li><li>Evaluation with MSE, MAE, Pearson, Spearman</li><li>Visualizations: loss curves, prediction scatter plots, histograms</li></ul><h2 class="text-2xl font-bold text-ember mb-2">🔍 NEFTune Ablation Study</h2><p class="mb-6 leading-relaxed">Tested with different noise scales (α) to measure ranking impact:</p><div class="overflow-x-auto mb-6"><table class="w-full text-sm text-left text-gray-400 border-collapse border border-gray-700"><thead class="bg-gray-800 text-ember"><tr><th class="px-4 py-2 border border-gray-700">Model</th><th class="px-4 py-2 border border-gray-700">α</th><th class="px-4 py-2 border border-gray-700">MSE</th><th class="px-4 py-2 border border-gray-700">MAE</th><th class="px-4 py-2 border border-gray-700">Pearson</th><th class="px-4 py-2 border border-gray-700">Spearman</th></tr></thead><tbody><tr><td class="px-4 py-2 border border-gray-700">Baseline</td><td class="px-4 py-2 border border-gray-700">0.0</td><td class="px-4 py-2 border border-gray-700">0.072</td><td class="px-4 py-2 border border-gray-700">0.203</td><td class="px-4 py-2 border border-gray-700">0.731</td><td class="px-4 py-2 border border-gray-700">0.775</td></tr><tr><td class="px-4 py-2 border border-gray-700">Alpha 0.5</td><td class="px-4 py-2 border border-gray-700">0.5</td><td class="px-4 py-2 border border-gray-700">0.068</td><td class="px-4 py-2 border border-gray-700">0.198</td><td class="px-4 py-2 border border-gray-700">0.774</td><td class="px-4 py-2 border border-gray-700 font-bold text-white">0.814</td></tr><tr><td class="px-4 py-2 border border-gray-700">Alpha 0.75</td><td class="px-4 py-2 border border-gray-700">0.75</td><td class="px-4 py-2 border border-gray-700">0.072</td><td class="px-4 py-2 border border-gray-700">0.201</td><td class="px-4 py-2 border border-gray-700">0.773</td><td class="px-4 py-2 border border-gray-700 font-bold text-white">0.818</td></tr><tr><td class="px-4 py-2 border border-gray-700">Alpha 1.0</td><td class="px-4 py-2 border border-gray-700">1.0</td><td class="px-4 py-2 border border-gray-700">0.082</td><td class="px-4 py-2 border border-gray-700">0.215</td><td class="px-4 py-2 border border-gray-700">0.748</td><td class="px-4 py-2 border border-gray-700">0.798</td></tr><tr><td class="px-4 py-2 border border-gray-700">Alpha 3.0</td><td class="px-4 py-2 border border-gray-700">3.0</td><td class="px-4 py-2 border border-gray-700">0.154</td><td class="px-4 py-2 border border-gray-700">0.299</td><td class="px-4 py-2 border border-gray-700">0.647</td><td class="px-4 py-2 border border-gray-700">0.762</td></tr></tbody></table></div><h2 class="text-2xl font-bold text-ember mb-2">📊 Visualizations</h2><p class="mb-4 leading-relaxed">We compare the training loss evolution for all models, and display NEFTune-style histograms for α = 0.75. Lower training loss does not always mean better generalization — as the log-scale test loss chart shows.</p><img src="https://raw.githubusercontent.com/MedhaviMonish/TwinSqueeze/main/results/loss_comparison.png" class="rounded shadow mb-6" alt="Loss Curves All Alphas"/><img src="https://raw.githubusercontent.com/MedhaviMonish/TwinSqueeze/main/results/benchmark_charts/loss_compare_alpha_0.75.png" class="rounded shadow mb-6" alt="Histogram NEFTune 0.75"/><h2 class="text-2xl font-bold text-ember mb-2">🔧 Run It Yourself</h2><div class="relative mb-6 rounded-lg overflow-hidden"><span class="absolute top-2 left-2 text-xs text-gray-300 px-2 py-0.5 rounded">bash</span><button class="absolute top-2 right-2 text-xs text-black bg-ember px-2 py-1 rounded hover:bg-orange-500 transition z-10">Copy</button><pre style="color:white;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:0.9rem;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.75rem 1.25rem 0.25rem 1.25rem;margin:0.5em 0;overflow:auto;background:transparent"><code class="language-bash" style="white-space:pre;color:#d6deeb;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:rgb(99, 119, 119);font-style:italic">1</span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># Install deps</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:rgb(99, 119, 119);font-style:italic">2</span><span>pip </span><span class="token" style="color:rgb(130, 170, 255)">install</span><span> torch datasets sentence-transformers matplotlib
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:rgb(99, 119, 119);font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:rgb(99, 119, 119);font-style:italic">4</span><span></span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># Run training</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:rgb(99, 119, 119);font-style:italic">5</span>python train_experiment.py
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:rgb(99, 119, 119);font-style:italic">6</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:rgb(99, 119, 119);font-style:italic">7</span><span></span><span class="token" style="color:rgb(99, 119, 119);font-style:italic"># Evaluate all saved models</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:rgb(99, 119, 119);font-style:italic">8</span>python test_all_models.py</code></pre></div><h2 class="text-2xl font-bold text-ember mb-2">📚 Learnings</h2><ul class="list-disc list-inside mb-6 text-gray-400 leading-relaxed"><li>How NEFTune improves ranking despite noisy training</li><li>Why smaller vectors can still preserve semantic relevance</li><li>When to use cosine vs MSE loss for contrastive objectives</li></ul><p class="mb-6 leading-relaxed">For anyone building RAG agents or compressing local memory for embedded search — <strong>TwinSqueeze</strong> gives you full control over similarity without overloading your hardware.</p><p class="text-gray-400 text-sm italic">Inspired by the NEFTune paper · Dataset: STS-B · Backbone: MiniLM</p></div><button class="fixed bottom-6 right-6 z-50 bg-ember text-black px-4 py-2 rounded-full shadow-lg hover:bg-orange-400 transition">↑ Top</button></main></div><script src="/_next/static/chunks/webpack-9edee2920554d0a5.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[15244,[],\"\"]\n3:I[43866,[],\"\"]\n4:I[57033,[],\"ClientPageRoot\"]\n5:I[39075,[\"932\",\"static/chunks/932-8bfdd8b6c3b22a28.js\",\"630\",\"static/chunks/app/blogs/twin-squeeze/page-a25cfe9e785361d0.js\"],\"default\"]\n8:I[86213,[],\"OutletBoundary\"]\na:I[86213,[],\"MetadataBoundary\"]\nc:I[86213,[],\"ViewportBoundary\"]\ne:I[34835,[],\"\"]\n:HL[\"/_next/static/css/b42ee275af96bf75.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"5McQakl_Cbp78y2_G-Spt\",\"p\":\"\",\"c\":[\"\",\"blogs\",\"twin-squeeze\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blogs\",{\"children\":[\"twin-squeeze\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b42ee275af96bf75.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"base\",null,{\"href\":\"./\"}]}],[\"$\",\"body\",null,{\"className\":\"relative min-h-screen bg-cover bg-center bg-no-repeat bg-fixed\",\"style\":{\"backgroundImage\":\"url('/images/bg-home.png')\"},\"children\":[\"$\",\"div\",null,{\"className\":\"bg-black/70 min-h-screen\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}]]}],{\"children\":[\"blogs\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blogs\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"twin-squeeze\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blogs\",\"children\",\"twin-squeeze\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"$L4\",null,{\"Component\":\"$5\",\"searchParams\":{},\"params\":{},\"promises\":[\"$@6\",\"$@7\"]}],null,[\"$\",\"$L8\",null,{\"children\":\"$L9\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"aPP7N5UZFiVKWk2BwZPLi\",{\"children\":[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],null]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"6:{}\n7:{}\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nb:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Medhavi Monish\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"AI Blacksmith forging intelligence from scratch\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n"])</script><script>self.__next_f.push([1,"9:null\n"])</script></body></html>